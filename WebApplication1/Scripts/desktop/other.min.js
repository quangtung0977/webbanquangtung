function LoadJsComment(){if(flsc!=!0&&typeof cmtaddcommentclick=="undefined"){flsc=!0;var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src=jsCommentUrl;(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(n);setTimeout(function(){InitEvent()},500)}}function SearchProduct(n){typingTimer&&clearTimeout(typingTimer);var t=$("#txtsuggest").val();typingTimer=setTimeout(function(){n.which!=8&&t.length>=2?SuggestProducts(n):n.which==8&&t.length==0&&(n.preventDefault,$("#listsuggest").hide(200))},doneTypingInterval)}function SuggestProducts(n){var r=$("#txtsuggest").val(),t,i,u,f,e;if(r!=""&&!(r.length<2)){if(t="#listsuggest li",n.which==40){$(t+".selected").length==0?$(t+":first").addClass("selected"):(i=$(t+".selected").next(),i.hasClass("li-group")&&(i=i.next()),$(t+".selected").removeClass("selected"),i.addClass("selected"));return}if(n.which==38){$(t+".selected").length==0?$(t+":last").addClass("selected"):(i=$(t+".selected").prev(),i.hasClass("li-group")&&(i=i.prev()),$(t+".selected").removeClass("selected"),i.addClass("selected"));return}if(n.which==13){n.preventDefault();$(t+".selected").length==0&&$(t+":first").addClass("selected");u=$(t+".selected a").attr("href");u!=undefined&&u!=""&&(window.location=u);return}f=!1;e=getQuerystring("clearcache");e!=undefined&&e=="1"&&(f=!0);r=r.replace(/:|;|!|@|@@|#|\$|%|\+|\^|&|'|"|>|<|,|\?|\/|`|~|=|_|\(|\)|{|}|\[|\]|\\|\|' '|/gi,"");r=r.replace(/ /g,"+");r=r.trim();POSTAjax("/aj/Other/AccessoriesSuggest",{Key:r,clearcache:f},BeforeSendAjax,function(n){EndSendAjax();n!=undefined&&n!=""?($(".listcity").hide(),$("#listsuggest").show(200),$("#listsuggest").html(n)):$("#listsuggest").html("<li>Không tìm thấy kết quả phù hợp<\/li>")},EndSendAjax,!0)}}function SaveProduct(n,t){n!=undefined&&n!=""&&($("#hdproductid").val(n),$("#listsuggest").slideUp(),$("#txtsuggest").val(t),$("#hdproductname").val(t),$(".list-result").hide(),BuildListReplacementPartType(n))}function BuildListReplacementPartType(n){var t=!1,i=getQuerystring("clearcache");i!=undefined&&i=="1"&&(t=!0);POSTAjax("/aj/Other/GenListReplacementPartType",{productid:n,clearcache:t},BeforeSendAjax,function(n){EndSendAjax();$(".citydis").show();n!=undefined&&n!=""?($(".list-result").hide(),$("#cur-acc").attr("data-id","-1").html("Chọn loại sửa chữa"),$(".scroll").html(n)):($(".list-result").show(),$(".list-result").css("color","red"),$(".list-result").html("Danh sách linh kiện thay thế chưa được khai báo, vui lòng quay lại sau."),$(".citydis").hide())},EndSendAjax,!0)}function InitTypePart(){$(".city").live("click",function(){$(".layer").not($(this).next()).hide();$(this).next().slideToggle()});$(".listcity .scroll a").live("click",function(){$(".listcity").hide();$("#cur-acc").attr("data-id",$(this).attr("data-value")).html($(this).text());var n=$("#hdproductid").val(),t=$("#cur-acc").attr("data-id");n==undefined||n==""||t==undefined||t==""?($(".list-result").show(),$(".list-result").css("color","red"),$(".list-result").html("Không tìm thấy bảng giá linh kiện sửa chữa, vui lòng thử lại sau.")):GetListReplacementPrice(n,t)})}function GetListReplacementPrice(n,t){if(n!=undefined&&n!=""&&t!=undefined&&t!=""){var i=!1,r=getQuerystring("clearcache");r!=undefined&&r=="1"&&(i=!0);POSTAjax("/aj/Other/AccessoriesReplacementPriceList",{productid:n,parttypeid:t,clearcache:i},function(){BeforeSendAjax();$(".list-result").show();$(".list-result").html("Đang tải dữ liệu...")},function(n){EndSendAjax();n!=undefined&&n!=""?($(".list-result").show(),$(".list-result").css("color","#333"),$(".list-result").html(n),$(".sp-name").html("Bảng giá sửa chữa "+$("#hdproductname").val())):($(".list-result").show(),$(".list-result").css("color","red"),$(".list-result").html("Không tìm thấy bảng giá linh kiện sửa chữa, vui lòng thử lại sau."))},EndSendAjax,!0)}}function GetAllFormData(n){var i=n.serializeArray(),t={};return $.map(i,function(n){t[n.name]=n.value}),t}function SubmitCustomerRegister(){if(SUBMIT_CUSTOMER_REGISTER){SUBMIT_CUSTOMER_REGISTER=!1;var n=GetAllFormData($("#frmCompanyCustomer"));$.ajax({type:"POST",cache:!1,beforeSend:function(){},data:n,url:"/aj/Other/SubmitCompanyCustomerRegister",success:function(n){if(n!=null||n!=""){var t=n.msg,i=n.result;i==1?alert(t):i==-3?alert(t):alert("Chức năng đang được bảo trì, vui lòng thử lại sau")}$("#dlding").fadeOut(1e3);SUBMIT_CUSTOMER_REGISTER=!0}})}}function SubmitContact(){var n=GetAllFormData($("#contactinfo"));return $.ajax({type:"POST",cache:!1,beforeSend:function(){},data:n,url:"/aj/Other/SubmitContact",success:function(n){var i,t;if(n!=null||n!="")if(n.status==1)alert("Đã gửi thông tin thành công!");else if(n.status==-3){t="Rất tiếc, thông tin bạn cung cấp chưa đúng: \n";for(i in n.errors)t+="-",t+=n.errors[i],t+="\n";alert(t)}else t=alert("Chức năng đang được bảo trì, vui lòng thử lại sau")}}),!1}function CheckCouponInfo(){var n=$("#txtCouponCode").val().trim();if(n==""){$(".business-coupon .r .error").html("Vui lòng nhập mã giảm giá/mã phiếu mua hàng cần tra cứu");$("#txtCouponCode").focus();$(".couponinfo-hide").html("");return}if(n.length!=12){$(".business-coupon .r .error").html("Mã thẻ không chính xác, vui lòng kiểm tra lại");$("#txtCouponCode").focus();$(".couponinfo-hide").html("");return}POSTAjax("/aj/Voucher/VoucherDetail",{strC:n},function(){$("#dlding").show()},function(n){(n==null||n=="")&&($("#err").html("Chức năng đang được bảo trì, vui lòng thử lại sau"),window.location.reload());typeof n=="object"?($(".r .error").html(n._errors[0]),$(".couponinfo-hide").html("")):($(".r .error").html(""),$(".couponinfo-hide").html(n))},function(){},!0)}function B2BSuggestSearch(n,t,i,r){var u,e,f;if($(".wrap-suggestion").remove(),typeof r=="undefined"&&(r=!1),u=$(t)===undefined?"":$(t).val(),u=u.trim().toLowerCase(),e=$(t).parents("form"),f=e.find(".wrap-suggestion-b2b"),n.which==40||n.which==38)return n.preventDefault(),UpDownSuggest(n.which),!1;if(n.which==13){if($("ul.wrap-suggestion li.selected").length>0)return location.href=$("ul.wrap-suggestion-b2b li.selected a").attr("href"),n.preventDefault(),!1;if(u.length<2){f.hide();return}}if(!r){clearTimeout(timmer);timmer=setTimeout(function(){B2BSuggestSearch(n,t,i,!0)},300);return}if(u.length<2){f.hide();return}$.ajax({url:"/aj/CommonV3/B2BSuggestSearch",type:"GET",data:{keyword:u,categoryID:i},cache:!1,success:function(n){clearTimeout(timmer);n==""?($(".wrap-suggestion-b2b").remove(),$(".wrap-suggestion").remove()):f.length>0?f.replaceWith(n):e.append(n)}})}function UpDownSuggest(n){var t="ul.wrap-suggestion-b2b li",i;if(n==40){$(t+".selected").length==0?$(t+":first").addClass("selected"):(i=$(t+".selected").next(),$(t+".selected").removeClass("selected"),i.addClass("selected"));return}if(n==38){$(t+".selected").length==0?$(t+":last").addClass("selected"):(i=$(t+".selected").prev(),$(t+".selected").removeClass("selected"),i.addClass("selected"));return}}function formatNumberValue(n){for(var i=n.toString().length,r=0,u="",f="",t;i%3!=0;)i++,r++;if(r!=0)for(t=0;t<r;t++)u+="0";for(u+=n.toString(),t=0;t<i;t++)f+=u.charAt(t),t>0&&(t+1)%3==0&&t!=i-1&&(f+=".");return f.substring(r)}function totalVoucher(){return $(".total-voucher").html(formatNumberValue(Number($("#prince-hidden").val())*Number($(".choosenumber .number").html()))+"đ")}function SubmitVouchertOrder(){if(IS_SubmitVoucherOrder){IS_SubmitVoucherOrder=!1;var n=GetAllFormData($("#pop-voucher"));$.ajax({type:"POST",cache:!1,beforeSend:function(){},data:n,url:"/aj/Voucher/SubmitVoucherCartb2b",success:function(n){if(n!=null||n!=""){var t=n.msg,i=n.result;i<0?$("#pop-voucher .pop-err").html(t):window.location.href="/b2b/succsess"}IS_SubmitVoucherOrder=!0}})}}function SubmitProductOrder(){if(IS_SubmitProductOrder){IS_SubmitProductOrder=!1;var n=GetAllFormData($("#frmBaogia"));$.ajax({type:"POST",cache:!1,beforeSend:function(){},data:n,url:"/aj/Voucher/SubmitProducPriceb2b",success:function(n){if(n!=null||n!=""){var t=n.msg,i=n.result;i<0?$("#frmBaogia .err-msg-popProduct").html(t):window.location.href=t}IS_SubmitProductOrder=!0}})}}var CHAT_GL_ENABLED=0,flsc,typingTimer,doneTypingInterval,SUBMIT_CUSTOMER_REGISTER,lastSuggest,timmer,IS_SubmitVoucherOrder,IS_SubmitProductOrder;$(document).ready(function(){var n,t,i;console.log("lien-he");n=window.location.href;n.indexOf("#phu-kien")>-1&&(t=$("#phu-kien").offset(),$("html, body").animate({scrollTop:t.top},1500));$("img.footermoneylazy").lazyload({});$("img.footerpinlazy").lazyload({});$("img.lazy").lazyload({threshold:150});$(window).scroll(function(){try{LoadJsComment()}catch(n){}});try{i=window.location.href;$("#help-navigation > ul > li > a").each(function(){$(this).parent().removeClass("active");var n=$(this).attr("href");if(i.indexOf(n)>-1)return $(this).parent().addClass("active"),!1})}catch(r){}window.location.href.indexOf("bang-gia-sua-chua")>-1&&InitTypePart()});flsc=!1;doneTypingInterval=80;$(".label-dknbg").click(function(){$("body,html").animate({scrollTop:600},"slow");$("#search-keyword-b2b").focus()});SUBMIT_CUSTOMER_REGISTER=!0;lastSuggest=(new Date).getTime();$(".question-area").click(function(){var n=$(this).closest(".question-content");n.find(".answer-busi").slideToggle()});$(".sl-voucher .choosenumber .augment").click(function(){$(".sl-voucher .choosenumber .abate").addClass("active");var n=Number($(".sl-voucher .choosenumber .number").html())+1;$(".sl-voucher .choosenumber .number").html(n);n===50&&$(".sl-voucher .choosenumber .augment").addClass("disable");$("#pop-voucher .voucherQuantity").val(n);totalVoucher()});$(".sl-voucher .choosenumber .abate").click(function(){$(".sl-voucher .choosenumber .augment").removeClass("disable");var n=Number($(".sl-voucher .choosenumber .number").html());n--;$(".sl-voucher .choosenumber .number").html(n);n===1&&$(".sl-voucher .choosenumber .abate").removeClass("active");$("#pop-voucher .voucherQuantity").val(n);totalVoucher()});$(".openPopupVoucher").click(function(){$(".pop-chk").each(function(){value=this.getAttribute("data-prince");value===$("#prince-hidden").val()?$(this).addClass("pop-chk-active"):$(this).removeClass("pop-chk-active");$("#pop-voucher .pop-err").html("")});totalVoucher();$("#pop-voucher .voucherPrice").val($(".pop-chk-active").attr("data-prince"));$("#pop-voucher .voucherCode").val($(".pop-chk-active").attr("data-code"));$(".popup-voucher").show()});$(".popupCloseButton").click(function(){$(".popup-voucher").hide()});$(".pop-chk").click(function(){$("#prince-hidden").val(this.getAttribute("data-prince"));$(".pop-chk").removeClass("pop-chk-active");$(this).addClass("pop-chk-active");$("#pop-voucher .voucherPrice").val($(".pop-chk-active").attr("data-prince"));$("#pop-voucher .voucherCode").val($(".pop-chk-active").attr("data-code"));totalVoucher()});$(".chk").click(function(){$("#prince-hidden").val(this.getAttribute("data-prince"));$(".chk").removeClass("chk-active");$(this).addClass("chk-active");totalVoucher()});IS_SubmitVoucherOrder=!0;$(".sl-product .choosenumber .number").change(function(){var n=$(".sl-product .choosenumber .number").val();if(/\D/.test(n)){n=1;$(".sl-product .choosenumber .number").val(n);$(".sl-product .choosenumber .abate ").removeClass("active");$(".sl-product .choosenumber .augment ").removeClass("disable");alert("Số lượng không hợp lệ, vui lòng nhập số nguyên");$("#frmBaogia .txtQuantity").val(n);return}if(n<1){n=1;$(".sl-product .choosenumber .number").val(n);$(".sl-product .choosenumber .abate ").removeClass("active");$(".sl-product .choosenumber .augment ").removeClass("disable");alert("Số lượng không hợp lệ, tối thiểu là 1");$("#frmBaogia .txtQuantity").val(n);return}if(n==1){$(".sl-product .choosenumber .number").val(n);$(".sl-product .choosenumber .abate ").removeClass("active");$(".sl-product .choosenumber .augment ").removeClass("disable");$("#frmBaogia .txtQuantity").val(n);return}if(n>1&&n<50){$(".sl-product .choosenumber .number").val(n);$(".sl-product .choosenumber .abate ").addClass("active");$(".sl-product .choosenumber .augment ").removeClass("disable");$("#frmBaogia .txtQuantity").val(n);return}if(n==50){$(".sl-product .choosenumber .number").val(n);$(".sl-product .choosenumber .abate ").addClass("active");$(".sl-product .choosenumber .augment ").addClass("disable");$("#frmBaogia .txtQuantity").val(n);return}if(n>50){n=1;$(".sl-product .choosenumber .number").val(n);$(".sl-product .choosenumber .abate ").removeClass("active");$(".sl-product .choosenumber .augment ").removeClass("disable");alert("Số lượng không hợp lệ, tối đa là 50");$("#frmBaogia .txtQuantity").val(n);return}});$(".sl-product .choosenumber .augment").click(function(){$(".sl-product .choosenumber .abate ").addClass("active");var n=Number($(".sl-product .choosenumber .number").val())+1;$(".sl-product .choosenumber .number").val(n);n===50&&$(".sl-product .choosenumber .augment").addClass("disable");$("#frmBaogia .txtQuantity").val(n)});$(".sl-product .choosenumber .abate").click(function(){$(".sl-product .choosenumber .augment ").removeClass("disable");var n=Number($(".sl-product .choosenumber .number").val());n--;$(".sl-product .choosenumber .number").val(n);n===1&&$(".sl-product .choosenumber .abate").removeClass("active");$("#frmBaogia .txtQuantity").val(n)});IS_SubmitProductOrder=!0;